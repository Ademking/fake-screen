{"version":3,"sources":["src/mcdonalds/index.js"],"names":["render","mcdonalds","setTimeout","start","wrapper","date","document","querySelector","couponPage","coupons","header","hamburgerIcon","nextHamburgerIcon","title","nextTitle","how","nextHow","hamburger","status","exp","couponFooter","couponFooterText","closeCouponPage","style","transform","opacity","onclick","handleExchange","e","preventDefault","textContent","Date","getFullYear","getMonth","getDate","onExchange","height","innerHTML","clock","className","clockB","expTime","setMinutes","getMinutes","countDowner","CountDowner","getLast","formatFromCB","timeArray","toFixStr","on","exchangedExps","querySelectorAll","Array","from","forEach","exchangeExp","stop"],"mappings":";;;;;;;AA8FC,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,YAAA,EA9FD,IAAA,EAAA,EAAA,QAAA,oBACA,QAAA,oBACA,IAAA,EAAA,EAAA,QAAA,gBACA,EAAA,EAAA,QAAA,kBACA,EAAA,EAAA,QAAA,6BA0FC,SAAA,EAAA,GAAA,OAAA,GAAA,EAAA,WAAA,EAAA,CAAA,QAAA,GAxFM,IAAMA,EAAS,WAEbC,OADPC,WAAWC,GACJF,EAAP,SAGF,SAASE,IACDC,IA0BEC,EA1BFD,EAAUE,SAASC,cAAc,sBACjCC,EAAaJ,EAAQG,cAAc,gBACnCE,EAAUL,EAAQG,cAAc,YAChCG,EAASN,EAAQG,cAAc,UAC/BI,EAAgBD,EAAOH,cAAc,kBACrCK,EAAoBF,EAAOH,cAAc,mBACzCM,EAAQH,EAAOH,cAAc,eAC7BO,EAAYJ,EAAOH,cAAc,oBACjCQ,EAAML,EAAOH,cAAc,aAC3BS,EAAUN,EAAOH,cAAc,kBAC/BU,EAAYP,EAAOH,cAAc,cACjCW,EAAST,EAAQF,cAAc,WAC/BY,EAAMV,EAAQF,cAAc,QAC5Ba,EAAeZ,EAAWD,cAAc,UACxCc,EAAmBD,EAAab,cAAc,aAwD3Ce,SAAAA,IACPd,EAAWe,MAAMC,UAAY,mBAC7Bb,EAAcY,MAAME,QAAU,MAC9Bb,EAAkBW,MAAME,QAAU,IAClCZ,EAAMU,MAAMC,UAAZ,iBACAX,EAAMU,MAAME,QAAU,MACtBX,EAAUS,MAAMC,UAAhB,mBACAV,EAAUS,MAAME,QAAU,IAC1BV,EAAIQ,MAAME,QAAU,MACpBT,EAAQO,MAAME,QAAU,IACxBR,EAAUS,QAAU,aAhEtBR,EAAOQ,QACEC,SAAeC,GACtBA,EAAEC,iBAyCFlB,EAAcY,MAAME,QAAU,IAC9Bb,EAAkBW,MAAME,QAAU,MAClCZ,EAAMU,MAAMC,UAAZ,oBACAX,EAAMU,MAAME,QAAU,IACtBX,EAAUS,MAAMC,UAAhB,iBACAV,EAAUS,MAAME,QAAU,MAC1BV,EAAIQ,MAAME,QAAU,IACpBT,EAAQO,MAAME,QAAU,MACxBjB,EAAWe,MAAMC,UAAY,iBAC7BP,EAAUS,QAAUJ,GA/CtBH,EAAIW,aAKIzB,EAAO,IAAI0B,KACJ1B,MAAAA,OAAAA,EAAK2B,cAAmB3B,OAAAA,OAAAA,EAAK4B,WACxC,EAAO5B,OAAAA,OAAAA,EAAK6B,UAAY,EAD1B,OALFd,EAAaM,QAAU,YAQdS,WACPf,EAAaG,MAAMa,OAAS,OAC5Bf,EAAiBgB,UAAsCC,0BAAAA,OAAAA,EAAvD,QAAA,6DACApB,EAAOqB,UAAY,oCACnBrB,EAAOmB,UAAsCG,0BAAAA,OAAAA,EAA7C,QAAA,6DACMC,IAAAA,EAAU,IAAIV,KACpBU,EAAQC,WAAWD,EAAQE,aAAe,GACpCC,IAAAA,EAAc,IAAIC,EAAJ,QAAgBJ,GAC9BK,EAAUF,EAAYG,aAC1B,SAAAC,GAAiBA,MAAAA,IAAAA,OAAAA,EAAU,GAAMJ,KAAAA,OAAAA,EAAYK,SAASD,EAAU,OAElEJ,EAAYM,GAAG,SAAU,WACnB,IACIC,IAAAA,EAAgB/C,EAAQgD,iBAAiB,kBAC/CC,MAAMC,KAAKH,GAAeI,QACxB,SAAAC,GAAgBA,OAAAA,EAAY1B,YAAcgB,MAE5C,MAAOlB,GACPgB,EAAYa,UAGhBb,EAAYM,GAAG,OAAQ,WACrB5B,IACAJ,EAAOQ,QAAU,aACjBR,EAAOqB,UAAY,SACnBrB,EAAOY,YAAc,QAhCvBK,IA2DH,QAAA,OAAA","file":"mcdonalds.9dbb0d63.map","sourceRoot":"..","sourcesContent":["import mcdonalds from './mcdonalds.pug';\r\nimport './mcdonalds.scss';\r\nimport clock from './clock.svg';\r\nimport clockB from './clock-b.svg';\r\nimport CountDowner from '../assets/CountDowner.js';\r\n\r\nexport const render = () => {\r\n  setTimeout(start);\r\n  return mcdonalds;\r\n};\r\n\r\nfunction start() {\r\n  const wrapper = document.querySelector('.mcdonalds-wrapper');\r\n  const couponPage = wrapper.querySelector('.coupon-page');\r\n  const coupons = wrapper.querySelector('.coupons');\r\n  const header = wrapper.querySelector('header');\r\n  const hamburgerIcon = header.querySelector('.hamburger img');\r\n  const nextHamburgerIcon = header.querySelector('.next-hamburger');\r\n  const title = header.querySelector('.title-text');\r\n  const nextTitle = header.querySelector('.next-title-text');\r\n  const how = header.querySelector('.how-text');\r\n  const nextHow = header.querySelector('.next-how-text');\r\n  const hamburger = header.querySelector('.hamburger');\r\n  const status = coupons.querySelector('.status');\r\n  const exp = coupons.querySelector('.exp');\r\n  const couponFooter = couponPage.querySelector('footer');\r\n  const couponFooterText = couponFooter.querySelector('.exchange');\r\n\r\n  status.onclick = handleExchange;\r\n  function handleExchange(e) {\r\n    e.preventDefault();\r\n    openCouponPage();\r\n  }\r\n  exp.textContent = setExp();\r\n  couponFooter.onclick = () => {\r\n    onExchange();\r\n  };\r\n  function setExp() {\r\n    const date = new Date();\r\n    return `期限：${date.getFullYear()} 年 ${date.getMonth() +\r\n      1} 月 ${date.getDate() + 3} 日`;\r\n  }\r\n  function onExchange() {\r\n    couponFooter.style.height = '90px';\r\n    couponFooterText.innerHTML = `<img class=\"clock\" src=${clock} alt=\"clock\"/>優惠倒數<span class=\"exchanged-exp\">2:00</span>`;\r\n    status.className = 'status exchange no-letter-spacing';\r\n    status.innerHTML = `<img class=\"clock\" src=${clockB} alt=\"clock\"/>優惠倒數<span class=\"exchanged-exp\">2:00</span>`;\r\n    const expTime = new Date();\r\n    expTime.setMinutes(expTime.getMinutes() + 2);\r\n    const countDowner = new CountDowner(expTime);\r\n    const getLast = countDowner.formatFromCB(\r\n      timeArray => ` ${timeArray[2]}:${countDowner.toFixStr(timeArray[3])}`,\r\n    );\r\n    countDowner.on('second', function setExpLast() {\r\n      try {\r\n        const exchangedExps = wrapper.querySelectorAll('.exchanged-exp');\r\n        Array.from(exchangedExps).forEach(\r\n          exchangeExp => (exchangeExp.textContent = getLast()),\r\n        );\r\n      } catch (e) {\r\n        countDowner.stop();\r\n      }\r\n    });\r\n    countDowner.on('stop', function onExpired() {\r\n      closeCouponPage();\r\n      status.onclick = () => {};\r\n      status.className = 'status';\r\n      status.textContent = '已兌換';\r\n    });\r\n  }\r\n  function openCouponPage() {\r\n    hamburgerIcon.style.opacity = '0';\r\n    nextHamburgerIcon.style.opacity = '100';\r\n    title.style.transform = `translateX(-200%)`;\r\n    title.style.opacity = '0';\r\n    nextTitle.style.transform = `translateX(0%)`;\r\n    nextTitle.style.opacity = '100';\r\n    how.style.opacity = '0';\r\n    nextHow.style.opacity = '100';\r\n    couponPage.style.transform = 'translateX(0%)';\r\n    hamburger.onclick = closeCouponPage;\r\n  }\r\n  function closeCouponPage() {\r\n    couponPage.style.transform = 'translateX(100%)';\r\n    hamburgerIcon.style.opacity = '100';\r\n    nextHamburgerIcon.style.opacity = '0';\r\n    title.style.transform = `translateX(0%)`;\r\n    title.style.opacity = '100';\r\n    nextTitle.style.transform = `translateX(200%)`;\r\n    nextTitle.style.opacity = '0';\r\n    how.style.opacity = '100';\r\n    nextHow.style.opacity = '0';\r\n    hamburger.onclick = () => {};\r\n  }\r\n}\r\n"]}