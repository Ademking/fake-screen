{"version":3,"sources":["src/wannacry/CountDowner.js","src/wannacry/index.js"],"names":["CountDowner","till","setSeconds","getSeconds","callbacks","stop","second","toFixStr","bind","interval","origin","Date","start","year","getFullYear","month","getMonth","date","getDate","hour","getHours","minute","getMinutes","map","s","join","percentage","timeDiff","getTime","diffDays","Math","floor","diffHours","diffMinutes","diffSeconds","e","setInterval","forEach","cb","clearInterval","str","push","Error","render","setTimeout","wannacry","pay","document","querySelector","payOn","payProgress","lost","lostOn","lostProgress","now","payDate","lostDate","payCountDowner","innerHTML","formatLast","formatTill","on","style","height","progress","lostCountDowner"],"mappings":"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","file":"wannacry.01b71242.map","sourceRoot":"..","sourcesContent":["class CountDowner {\n  constructor(till) {\n    till.setSeconds(till.getSeconds() + 1);\n    this.till = till;\n    this.callbacks = {\n      stop: [],\n      second: [],\n    };\n    this.toFixStr = this.toFixStr.bind(this);\n    this.interval = null;\n    this.origin = new Date();\n    this.start();\n  }\n  formatTill() {\n    const year = this.till.getFullYear();\n    const month = this.till.getMonth() + 1;\n    const date = this.till.getDate();\n    const hour = this.till.getHours();\n    const minute = this.till.getMinutes();\n    const second = this.till.getSeconds();\n    return (\n      [month, date, year].map(s => this.toFixStr(s)).join('/') +\n      ' ' +\n      [hour, minute, second].map(s => this.toFixStr(s)).join(':')\n    );\n  }\n  toFixStr(s) {\n    return (s < 10 ? '0' : '') + s;\n  }\n  progress() {\n    const percentage = this.timeDiff / (this.till.getTime() - this.origin);\n    return percentage < 0 ? 0 : percentage;\n  }\n  formatLast() {\n    const diffDays = Math.floor(this.timeDiff / (1000 * 3600 * 24));\n    const diffHours = Math.floor(this.timeDiff / (1000 * 3600));\n    const diffMinutes = Math.floor(this.timeDiff / (1000 * 60));\n    const diffSeconds = Math.floor(this.timeDiff / 1000);\n    return [\n      diffDays,\n      diffHours - diffDays * 24,\n      diffMinutes - diffHours * 60,\n      diffSeconds - diffMinutes * 60,\n    ]\n      .map(e => this.toFixStr(e))\n      .join(':');\n  }\n  start() {\n    this.timeDiff = this.till.getTime() - new Date().getTime();\n    this.interval = setInterval(() => {\n      this.timeDiff = this.till.getTime() - new Date().getTime();\n      if (this.timeDiff < 0) {\n        this.stop();\n      } else {\n        this.callbacks.second.forEach(cb => cb());\n      }\n    }, 1000);\n  }\n  stop() {\n    clearInterval(this.interval);\n    this.callbacks.stop.forEach(cb => cb());\n  }\n  on(str, cb) {\n    if (str in this.callbacks) {\n      this.callbacks[str].push(cb);\n    } else {\n      throw Error(`no ${str} type callback`);\n    }\n  }\n}\n\nexport default CountDowner;\n","import 'babel-polyfill';\nimport CountDowner from './CountDowner.js';\nimport './wannacry.scss';\nimport wannacry from './wannacry.pug';\n\nexport const render = () => {\n  setTimeout(start);\n  return wannacry;\n};\n\nfunction start() {\n  const pay = document.querySelector('#pay');\n  const payOn = document.querySelector('#pay-on');\n  const payProgress = document.querySelector('#pay-progress');\n  const lost = document.querySelector('#lost');\n  const lostOn = document.querySelector('#lost-on');\n  const lostProgress = document.querySelector('#lost-progress');\n\n  const now = new Date();\n  const payDate = new Date(\n    now.getFullYear(),\n    now.getMonth(),\n    now.getDate(),\n    now.getHours(),\n    now.getMinutes(),\n    now.getSeconds() + 10,\n  );\n  const lostDate = new Date(\n    now.getFullYear(),\n    now.getMonth(),\n    now.getDate(),\n    now.getHours() + 1,\n    now.getMinutes(),\n    now.getSeconds(),\n  );\n  const payCountDowner = new CountDowner(payDate);\n  pay.innerHTML = payCountDowner.formatLast();\n  payOn.innerHTML = payCountDowner.formatTill();\n  payCountDowner.on('second', () => {\n    payProgress.style.height = `${(1 - payCountDowner.progress()) * 100}%`;\n    pay.innerHTML = payCountDowner.formatLast();\n  });\n  payCountDowner.on('stop', () => {\n    payProgress.style.height = `${(1 - payCountDowner.progress()) * 100}%`;\n  });\n  const lostCountDowner = new CountDowner(lostDate);\n  lost.innerHTML = lostCountDowner.formatLast();\n  lostOn.innerHTML = lostCountDowner.formatTill();\n  lostCountDowner.on('second', () => {\n    lostProgress.style.height = `${(1 - lostCountDowner.progress()) * 100}%`;\n    lost.innerHTML = lostCountDowner.formatLast();\n  });\n  lostCountDowner.on('stop', () => {\n    lostProgress.style.height = `${(1 - lostCountDowner.progress()) * 100}%`;\n  });\n}\n"]}